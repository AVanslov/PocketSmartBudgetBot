db-1       | 2024-05-25 14:27:44.077 UTC [58] ERROR:  more than one row returned by a subquery used as an expression

db-1       | 2024-05-25 14:27:44.077 UTC [58] 
    STATEMENT:  
        SELECT 
            "bot_category"."id",
            "bot_category"."type_id", 
            "bot_category"."category", 
            "bot_category"."limit", 
            "bot_category"."author_id", 
            ROUND(
                (
                    (
                        SELECT COALESCE(
                            SUM(
                                (
                                    V0."value" / (
                                        SELECT U0."rate" FROM "bot_rate" U0 WHERE (
                                            U0."date" = (V0."date")
                                            AND U0."first_currency_id" = (V3."main_currency_id")
                                            AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))), 0
                                    ) AS "total_value" 
                                        FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id")
                                        LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id")
                                        WHERE (
                                            V0."author_id" = 2
                                            AND V0."category_id" = ("bot_category"."id")
                                            AND 
                                                V0."date" BETWEEN '2024-01-01'::date
                                                AND '2024-12-31'::date
                                        ) GROUP BY V0."id"
                                )
                            )::numeric(1000, 15), 2
                        ) AS "values_in_main_currency",
                        ROUND(
                              (
                                    COALESCE(
                                                (   
                                                    SELECT COALESCE(
                                                        SUM(
                                                                (
                                                                    V0."value" / (
                                                                        SELECT U0."rate" FROM "bot_rate" U0 WHERE (
                                                                            U0."date" = (V0."date") 
                                                                            AND U0."first_currency_id" = (V3."main_currency_id")
                                                                            AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1
                                                                    )
                                                                )
                                                        ) FILTER (
                                                            WHERE (
                                                                EXTRACT(MONTH FROM V0."date") = 1
                                                            )), 0
                                                    ) AS "jan" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") 
                                                    LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id")
                                                    WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") 
                                                    AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date)
                                                    GROUP BY V0."id"), 0))::numeric(1000, 15), 2)
                                                    AS "jan", ROUND(
                                                            (
                                                                    COALESCE(
                                                                                (
                                                                                    SELECT COALESCE(
                                                                                        SUM(
                                                                                                (
                                                                                                    V0."value" / (
                                                                                                            SELECT U0."rate" FROM "bot_rate" U0
                                                                                                            WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 2)), 0) AS "feb" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "feb", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 3)), 0) AS "mar" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "mar", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 4)), 0) AS "apr" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "apr", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 5)), 0) AS "may" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "may", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 6)), 0) AS "jun" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jun", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 7)), 0) AS "jul" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jul", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 8)), 0) AS "aug" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "aug", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 9)), 0) AS "sep" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "sep", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 10)), 0) AS "oct" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "oct", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 11)), 0) AS "nov" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "nov", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 12)), 0) AS "dec" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "dec", ROUND((("bot_category"."limit" - ROUND(((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))), 0) AS "total_value" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"))::numeric(1000, 15), 2)))::numeric(1000, 15), 2) AS "difference" FROM "bot_category" INNER JOIN "bot_type" ON ("bot_category"."type_id" = "bot_type"."id") WHERE ("bot_category"."author_id" = 2 AND "bot_type"."name" = 'expenses')
db-1       | 2024-05-25 14:27:44.123 UTC [58] ERROR:  more than one row returned by a subquery used as an expression
db-1       | 2024-05-25 14:27:44.123 UTC [58] STATEMENT:  SELECT "bot_category"."id", "bot_category"."type_id", "bot_category"."category", "bot_category"."limit", "bot_category"."author_id", ROUND(((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))), 0) AS "total_value" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"))::numeric(1000, 15), 2) AS "values_in_main_currency", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 1)), 0) AS "jan" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jan", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 2)), 0) AS "feb" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "feb", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 3)), 0) AS "mar" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "mar", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 4)), 0) AS "apr" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "apr", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 5)), 0) AS "may" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "may", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 6)), 0) AS "jun" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jun", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 7)), 0) AS "jul" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jul", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 8)), 0) AS "aug" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "aug", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 9)), 0) AS "sep" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "sep", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 10)), 0) AS "oct" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "oct", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 11)), 0) AS "nov" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "nov", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 12)), 0) AS "dec" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "dec", ROUND((("bot_category"."limit" - ROUND(((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))), 0) AS "total_value" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"))::numeric(1000, 15), 2)))::numeric(1000, 15), 2) AS "difference" FROM "bot_category" INNER JOIN "bot_type" ON ("bot_category"."type_id" = "bot_type"."id") WHERE ("bot_category"."author_id" = 2 AND "bot_type"."name" = 'expenses') LIMIT 21
db-1       | 2024-05-25 14:27:44.135 UTC [58] ERROR:  more than one row returned by a subquery used as an expression
db-1       | 2024-05-25 14:27:44.135 UTC [58] STATEMENT:  SELECT "bot_category"."id", "bot_category"."type_id", "bot_category"."category", "bot_category"."limit", "bot_category"."author_id", ROUND(((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))), 0) AS "total_value" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"))::numeric(1000, 15), 2) AS "values_in_main_currency", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 1)), 0) AS "jan" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jan", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 2)), 0) AS "feb" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "feb", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 3)), 0) AS "mar" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "mar", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 4)), 0) AS "apr" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "apr", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 5)), 0) AS "may" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "may", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 6)), 0) AS "jun" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jun", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 7)), 0) AS "jul" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jul", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 8)), 0) AS "aug" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "aug", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 9)), 0) AS "sep" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "sep", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 10)), 0) AS "oct" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "oct", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 11)), 0) AS "nov" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "nov", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 12)), 0) AS "dec" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "dec", ROUND((("bot_category"."limit" - ROUND(((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))), 0) AS "total_value" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"))::numeric(1000, 15), 2)))::numeric(1000, 15), 2) AS "difference" FROM "bot_category" INNER JOIN "bot_type" ON ("bot_category"."type_id" = "bot_type"."id") WHERE ("bot_category"."author_id" = 2 AND "bot_type"."name" = 'expenses') LIMIT 21
db-1       | 2024-05-25 14:27:44.147 UTC [58] ERROR:  more than one row returned by a subquery used as an expression
db-1       | 2024-05-25 14:27:44.147 UTC [58] STATEMENT:  SELECT "bot_category"."id", "bot_category"."type_id", "bot_category"."category", "bot_category"."limit", "bot_category"."author_id", ROUND(((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))), 0) AS "total_value" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"))::numeric(1000, 15), 2) AS "values_in_main_currency", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 1)), 0) AS "jan" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jan", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 2)), 0) AS "feb" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "feb", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 3)), 0) AS "mar" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "mar", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 4)), 0) AS "apr" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "apr", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 5)), 0) AS "may" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "may", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 6)), 0) AS "jun" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jun", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 7)), 0) AS "jul" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "jul", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 8)), 0) AS "aug" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "aug", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 9)), 0) AS "sep" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "sep", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 10)), 0) AS "oct" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "oct", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 11)), 0) AS "nov" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "nov", ROUND((COALESCE((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))) FILTER (WHERE (EXTRACT(MONTH FROM V0."date") = 12)), 0) AS "dec" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"), 0))::numeric(1000, 15), 2) AS "dec", ROUND((("bot_category"."limit" - ROUND(((SELECT COALESCE(SUM((V0."value" / (SELECT U0."rate" FROM "bot_rate" U0 WHERE (U0."date" = (V0."date") AND U0."first_currency_id" = (V3."main_currency_id") AND U0."second_currency_id" = (V0."currency_id")) LIMIT 1))), 0) AS "total_value" FROM "bot_money" V0 INNER JOIN "auth_user" V1 ON (V0."author_id" = V1."id") LEFT OUTER JOIN "bot_usermaincurrency" V3 ON (V1."id" = V3."author_id") WHERE (V0."author_id" = 2 AND V0."category_id" = ("bot_category"."id") AND V0."date" BETWEEN '2024-01-01'::date AND '2024-12-31'::date) GROUP BY V0."id"))::numeric(1000, 15), 2)))::numeric(1000, 15), 2) AS "difference" FROM "bot_category" INNER JOIN "bot_type" ON ("bot_category"."type_id" = "bot_type"."id") WHERE ("bot_category"."author_id" = 2 AND "bot_type"."name" = 'expenses') LIMIT 21
gateway-1  | 172.18.0.1 - - [25/May/2024:14:27:44 +0000] "POST /dashboard/ HTTP/1.1" 500 145 "http://localhost:8000/dashboard/" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36" "-"